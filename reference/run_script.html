<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Execute an R script inside a Docker container — run_script • jetty</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Execute an R script inside a Docker container — run_script"><meta name="description" content="This function is somewhat similar in spirit to
callr::rscript() in that the user can specify
an R script to be executed within the context of a Docker container."><meta property="og:description" content="This function is somewhat similar in spirit to
callr::rscript() in that the user can specify
an R script to be executed within the context of a Docker container."><meta property="og:image" content="https://dmolitor.com/jetty/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">jetty</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dmolitor/jetty/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Execute an R script inside a Docker container</h1>
      <small class="dont-index">Source: <a href="https://github.com/dmolitor/jetty/blob/main/R/script.R" class="external-link"><code>R/script.R</code></a></small>
      <div class="d-none name"><code>run_script.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is somewhat similar in spirit to
<code><a href="https://callr.r-lib.org/reference/rscript.html" class="external-link">callr::rscript()</a></code> in that the user can specify
an R script to be executed within the context of a Docker container.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_script</span><span class="op">(</span></span>
<span>  <span class="va">file</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  context <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span>,</span>
<span>  image <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"r-base:"</span>, <span class="fu">r_version</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  stdout <span class="op">=</span> <span class="st">""</span>,</span>
<span>  stderr <span class="op">=</span> <span class="st">""</span>,</span>
<span>  install_dependencies <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  r_profile <span class="op">=</span> <span class="fu">jetty_r_profile</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  r_environ <span class="op">=</span> <span class="fu">jetty_r_environ</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>A character string giving the pathname of the file to read from.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments to be passed directly to <code><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></code>.</p></dd>


<dt id="arg-context">context<a class="anchor" aria-label="anchor" href="#arg-context"></a></dt>
<dd><p>The pathname of the directory to serve as the execution context.
This directory will be mounted to the Docker container, which
means that the script will have access to all files/directories that are
within the context directory. The context will also serve as the working
directory from which the script is executed. It is crucial to note that the
script will NOT be able to access any files/directories that are outside the
scope of the context directory. The default value is the directory that
<code>file</code> is contained in.</p></dd>


<dt id="arg-image">image<a class="anchor" aria-label="anchor" href="#arg-image"></a></dt>
<dd><p>A string in the <code>image:tag</code> format specifying either a local
Docker image or an image available on DockerHub. Default image is
<code>r-base:{jetty:::r_version()}</code> where your R version is determined from
your local R session.</p></dd>


<dt id="arg-stdout-stderr">stdout, stderr<a class="anchor" aria-label="anchor" href="#arg-stdout-stderr"></a></dt>
<dd><p>where output to ‘stdout’ or ‘stderr’ should be sent.
Possible values are "", to the R console (the default), NULL
(discard output), FALSE (discard output), TRUE
(capture the output silently and then discard), or a
character string naming a file. See <code><a href="https://rdrr.io/r/base/system2.html" class="external-link">system2</a></code> which this
function uses under the hood; however, note that <code><a href="https://rdrr.io/r/base/system2.html" class="external-link">system2</a></code>
handles these options slightly differently.</p></dd>


<dt id="arg-install-dependencies">install_dependencies<a class="anchor" aria-label="anchor" href="#arg-install-dependencies"></a></dt>
<dd><p>A boolean indicating whether jetty should
discover packages used in your code and try to install them in the
Docker container prior to executing the provided function/expression.
In general, things will work better if the Docker image already has all
necessary packages installed.</p></dd>


<dt id="arg-r-profile-r-environ">r_profile, r_environ<a class="anchor" aria-label="anchor" href="#arg-r-profile-r-environ"></a></dt>
<dd><p>Paths specifying where jetty should search for
the .Rprofile and .Renviron files to transfer to the Docker sub-process.
By default jetty will look for files called ".Rprofile" and ".Renviron"
in the current working directory. If either file is found, they will be
transferred to the Docker sub-process and loaded before executing any
R commands. To explicitly exclude either file, set the value to
<code>NULL</code>. Alternatively, to exclude either file for all jetty function
calls, set the <code>JETTY_IGNORE_RPROFILE</code>/<code>JETTY_IGNORE_RENVIRON</code>
environment variable(s) to one of <code>c(TRUE, "T")</code> or set the R
option(s) <code>jetty.ignore.rprofile</code>/<code>jetty.ignore.renviron</code>
<code>TRUE</code>.</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>A boolean indicating whether to print out the commands that are
being executed via the shell. This is mostly helpful to see what is
happening when things start to error.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The value of the last evaluated expression in the script.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><b>NOTE</b>: this feature is still fairly experimental. It will <em>NOT</em>
work on Windows. It is only made to be compatible with MacOS and Linux.</p>
    </div>
    <div class="section level2">
    <h2 id="interaction-with-the-local-file-system">Interaction with the local file system<a class="anchor" aria-label="anchor" href="#interaction-with-the-local-file-system"></a></h2>



<p>The user will be asked to specify a <code>context</code> (local directory)
for executing the R script. jetty mounts this directory to the Docker
container, allowing the script to interact with files within it
(read/write). Attempts to access files outside the context directory
will cause the script to fail. Ensure the context directory includes
all files needed for the script to run.</p>
    </div>
    <div class="section level2">
    <h2 id="error-handling">Error handling<a class="anchor" aria-label="anchor" href="#error-handling"></a></h2>



<p><code>run_script</code> will handle errors using the same mechanism as
<code><a href="run.html">run</a></code>. See that documentation for more details.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Execute a simple script that has no package dependencies</span></span></span>
<span class="r-in"><span><span class="fu">run_script</span><span class="op">(</span>file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"code/analysis_script.R"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Execute a script that needs access to the entire analysis directory</span></span></span>
<span class="r-in"><span><span class="fu">run_script</span><span class="op">(</span></span></span>
<span class="r-in"><span>  file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"code/analysis_script.R"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  context <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Execute a script that needs access to the entire analysis directory</span></span></span>
<span class="r-in"><span><span class="co"># and relies on external packages</span></span></span>
<span class="r-in"><span><span class="fu">run_script</span><span class="op">(</span></span></span>
<span class="r-in"><span>  file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"code/analysis_script.R"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  context <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  install_dependencies <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Execute a script and explicitly ignore an existing .Rprofile</span></span></span>
<span class="r-in"><span><span class="fu">run_script</span><span class="op">(</span></span></span>
<span class="r-in"><span>  file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"code/analysis_script.R"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  r_profile <span class="op">=</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Molitor.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

